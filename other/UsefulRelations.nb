(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84288,       2804]
NotebookOptionsPosition[     78508,       2604]
NotebookOutlinePosition[     78866,       2620]
CellTagsIndexPosition[     78823,       2617]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.668185190213875*^9, 3.668185198161888*^9}, {
   3.668185233619526*^9, 3.668185245033572*^9}, {3.668185403186119*^9, 
   3.668185430034101*^9}, 3.674027339346416*^9}],

Cell[CellGroupData[{

Cell["PhotoZ kernel", "Section",
 CellChangeTimes->{{3.6740273508046007`*^9, 3.674027354424135*^9}}],

Cell[CellGroupData[{

Cell["Useful integrals and derivatives", "Subsection",
 CellChangeTimes->{{3.674027367760593*^9, 3.674027378807643*^9}, {
  3.674027442550253*^9, 3.674027447268525*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", ">", "0"}], "&&", 
    RowBox[{"z1", ">", "0"}], "&&", 
    RowBox[{"z2", ">", "0"}], "&&", 
    RowBox[{"s1", ">", "0"}], "&&", 
    RowBox[{"s2", ">", "0"}]}], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"mu2", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", "z2"}], ")"}], "*", "l2"}]}], ")"}], "/", 
             "s2"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", "z1"}], ")"}], "*", "l1"}], "-", "mu1"}], 
              ")"}], "/", "s1"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l1", "-", "l2"}], ")"}], "/", "a"}], ")"}], "^", 
           "2"}]}], ")"}]}], "/", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l2", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"l1", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.668197275450081*^9, 3.668197344671256*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mu2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
         RowBox[{"mu1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["s2", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["s1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}]}]]}]], " ", 
   "\[Pi]", " ", "s1", " ", "s2"}], 
  SqrtBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["s2", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["s1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}]]]], "Output",
 CellChangeTimes->{3.668197427226241*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"a_", ",", "z1_", ",", "z2_"}], "]"}], "=", 
  FractionBox[
   RowBox[{"2", " ", "a", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mu2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
          RowBox[{"mu1", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["sig2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["sig1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}]}]]}]], " ", 
    "\[Pi]", " ", "sig1", " ", "sig2"}], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["sig2", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sig1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}]]]}]], "Input",
 CellChangeTimes->{{3.671298341129633*^9, 3.671298342376032*^9}, {
  3.674032928467078*^9, 3.674032930842615*^9}, {3.6740329761632347`*^9, 
  3.674032994730473*^9}, {3.6740334021608143`*^9, 3.6740334042881813`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "a", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mu2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
         RowBox[{"mu1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["sig2", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["sig1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}]}]]}]], " ", 
   "\[Pi]", " ", "sig1", " ", "sig2"}], 
  SqrtBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["sig2", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["sig1", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}]]]], "Output",
 CellChangeTimes->{
  3.672094970826538*^9, 3.674032392597568*^9, 3.674032945472621*^9, {
   3.674032984474143*^9, 3.6740329950499887`*^9}, 3.674033408418098*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"a", ",", "z1", ",", "z2"}], "]"}], ",", "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.6720949743739853`*^9, 3.672094980306644*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mu2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
          RowBox[{"mu1", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["sig2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["sig1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}]}]]}]], " ", 
    "\[Pi]", " ", "sig1", " ", "sig2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"mu2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
       RowBox[{"mu1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["sig2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["sig1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}], 
    RowBox[{"5", "/", "2"}]]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mu2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
          RowBox[{"mu1", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["sig2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["sig1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}]}]]}]], " ", 
    "\[Pi]", " ", "sig1", " ", "sig2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z2"}], ")"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["sig2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["sig1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mu2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
          RowBox[{"mu1", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["sig2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["sig1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}], ")"}]}]]}]], " ", 
    "\[Pi]", " ", "sig1", " ", "sig2"}], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["sig2", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["sig1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z2"}], ")"}], "2"]}]}]]]}]], "Output",
 CellChangeTimes->{{3.672094971841209*^9, 3.67209498075527*^9}, 
   3.674032947124017*^9, 3.674032997786441*^9, 3.674033410085671*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"alpha_C", ",", "z1", ",", "z2"}], "]"}], ",", "z1"}], "]"}]], \
"Input",
 CellChangeTimes->{{3.6740323838350973`*^9, 3.67403238541735*^9}, {
   3.674032819590769*^9, 3.6740328208856688`*^9}, 3.674033031665414*^9, {
   3.67403312902689*^9, 3.674033129370281*^9}, 3.6740331743205757`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mu2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
             RowBox[{"mu1", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["sig2", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox["sig1", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
              SuperscriptBox["alpha_C", "2"]}]}], ")"}]}]]}]], " ", "\[Pi]", 
       " ", "sig1", " ", "sig2", " ", "alpha_C", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["sig2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
          SuperscriptBox["alpha_C", "2"]}]}], ")"}]}], ")"}], "/", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["sig2", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox["sig1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
         SuperscriptBox["alpha_C", "2"]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mu2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
           RowBox[{"mu1", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["sig2", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["sig1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
            SuperscriptBox["alpha_C", "2"]}]}], ")"}]}]]}]], " ", "\[Pi]", 
     " ", "sig1", " ", "sig2", " ", "alpha_C", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mu2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
            RowBox[{"mu1", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["sig2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
            SuperscriptBox["alpha_C", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["sig2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["sig1", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
             SuperscriptBox["alpha_C", "2"]}]}], ")"}], "2"]}]], "-", 
       FractionBox[
        RowBox[{"mu2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"mu2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
           RowBox[{"mu1", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["sig2", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox["sig1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
          SuperscriptBox["alpha_C", "2"]}]}]]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    SqrtBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["sig2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["sig1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z1"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
       SuperscriptBox["alpha_C", "2"]}]}]], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.674033174613759*^9, 3.674033197736011*^9}, 
   3.674033411866469*^9}],

Cell[BoxData[""], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["sig2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "z1"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "z1"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z2"}], ")"}], "2"], " ", 
      SuperscriptBox["alpha_C", "2"]}]}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mu2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
         RowBox[{"mu1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], "2"], "/", 
      RowBox[{"Sigma", "^", "4"}]}], " ", "-", " ", 
     RowBox[{"1", "/", 
      RowBox[{"Sigma", "^", "2"}]}]}], " ", ")"}]}], " ", "-", " ", 
  RowBox[{"mu2", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mu2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z1"}], ")"}]}], "-", 
      RowBox[{"mu1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z2"}], ")"}]}]}], ")"}], " ", "/", " ", 
    RowBox[{"Sigma", "^", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.674035128474063*^9, 3.674035211117391*^9}}],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Assuming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"alpha", " ", ">", " ", "0"}], " ", "&&", 
    RowBox[{"lambdaRef", ">", "0"}], "&&", " ", 
    RowBox[{"z", ">", "0"}], "&&", 
    RowBox[{"mu", ">", "0"}], "&&", 
    RowBox[{"sigma", ">", "0"}]}], ",", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "alpha"}], "*", 
        RowBox[{"(", 
         RowBox[{"lambda", "-", "lambdaRef"}], ")"}]}], "]"}], "*", 
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"mu", ",", " ", "sigma"}], "]"}], ",", 
        RowBox[{"lambda", "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"lambda", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674811203458006*^9, 3.674811364829608*^9}, {
  3.674812239482156*^9, 3.674812295786931*^9}, {3.674812367029644*^9, 
  3.674812377635826*^9}, {3.674812452611805*^9, 3.674812483366199*^9}, {
  3.674812869489582*^9, 3.674812885032843*^9}, {3.67481295626089*^9, 
  3.674812956299717*^9}, {3.674817874653777*^9, 3.674817906017617*^9}, {
  3.674817965080942*^9, 3.67481796898407*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"alpha", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"alpha", " ", 
         SuperscriptBox["sigma", "2"]}], "-", 
        RowBox[{"2", " ", "mu", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}], "+", 
        RowBox[{"2", " ", "lambdaRef", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"]}]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}], "2"]}]]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{"mu", "-", 
        RowBox[{"alpha", " ", 
         SuperscriptBox["sigma", "2"]}], "+", 
        RowBox[{"mu", " ", "z"}]}], 
       RowBox[{
        SqrtBox["2"], " ", "sigma", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}]}]], "]"}]}], ")"}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "z"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.674811341537517*^9, 3.674811367417304*^9}, {
   3.674812245401861*^9, 3.6748122574691257`*^9}, {3.674812368637409*^9, 
   3.674812378077938*^9}, {3.674812471748138*^9, 3.67481247722935*^9}, {
   3.674812878761558*^9, 3.6748129038157043`*^9}, 3.674812958046163*^9, {
   3.674817889997414*^9, 3.6748179134052687`*^9}, {3.6748179726150293`*^9, 
   3.674817977052116*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"alpha", ",", "t_"}], "]"}], "=", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"alpha", " ", "t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"alpha", " ", "t", " ", 
        RowBox[{
         RowBox[{
          SuperscriptBox["sigma", "2"], "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}], "2"]}], "/", "2"}]}], "-", 
       RowBox[{"mu", " ", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}]}], "+", "lambdaRef"}], ")"}]}]], " ", 
   
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"mu", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}], "-", 
        RowBox[{"alpha", " ", "t", " ", 
         SuperscriptBox["sigma", "2"]}]}], 
       RowBox[{
        SqrtBox["2"], " ", "sigma", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}]}]], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.674820959094705*^9, 3.674821076714828*^9}, {
  3.6748222976582193`*^9, 3.6748223008609343`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"alpha", " ", "t", " ", 
    RowBox[{"(", 
     RowBox[{"lambdaRef", "+", 
      FractionBox[
       RowBox[{"alpha", " ", 
        SuperscriptBox["sigma", "2"], " ", "t"}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
      FractionBox["mu", 
       RowBox[{"1", "+", "z"}]]}], ")"}]}]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"Erf", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "alpha"}], " ", 
        SuperscriptBox["sigma", "2"], " ", "t"}], "+", 
       RowBox[{"mu", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}]}]}], 
      RowBox[{
       SqrtBox["2"], " ", "sigma", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}]}]], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.674821079811448*^9, 3.674822301371955*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"alpha", ",", "t"}], "]"}], ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.674821084949457*^9, 3.6748210906308203`*^9}, {
  3.6748223037030487`*^9, 3.6748223043593187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"alpha", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"alpha", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{"lambdaRef", "+", 
          FractionBox[
           RowBox[{"alpha", " ", 
            SuperscriptBox["sigma", "2"], " ", "t"}], 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
          FractionBox["mu", 
           RowBox[{"1", "+", "z"}]]}], ")"}]}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "alpha"}], " ", 
            SuperscriptBox["sigma", "2"], " ", "t"}], "+", 
           RowBox[{"mu", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["sigma", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"]}]]}]], " ", 
     SqrtBox[
      FractionBox["2", "\[Pi]"]], " ", "sigma"}], 
    RowBox[{"1", "+", "z"}]]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"alpha", " ", "t", " ", 
     RowBox[{"(", 
      RowBox[{"lambdaRef", "+", 
       FractionBox[
        RowBox[{"alpha", " ", 
         SuperscriptBox["sigma", "2"], " ", "t"}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
       FractionBox["mu", 
        RowBox[{"1", "+", "z"}]]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["alpha", "2"], " ", 
       SuperscriptBox["sigma", "2"], " ", "t"}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "+", 
     RowBox[{"alpha", " ", 
      RowBox[{"(", 
       RowBox[{"lambdaRef", "+", 
        FractionBox[
         RowBox[{"alpha", " ", 
          SuperscriptBox["sigma", "2"], " ", "t"}], 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
        FractionBox["mu", 
         RowBox[{"1", "+", "z"}]]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         SuperscriptBox["sigma", "2"], " ", "t"}], "+", 
        RowBox[{"mu", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}]}], 
       RowBox[{
        SqrtBox["2"], " ", "sigma", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}]}]], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.67482109103338*^9, 3.6748223047183323`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"alpha", ",", "t"}], "]"}], ",", "alpha"}], "]"}]], "Input",
 CellChangeTimes->{{3.674822312180551*^9, 3.674822314619275*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"alpha", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{"lambdaRef", "+", 
          FractionBox[
           RowBox[{"alpha", " ", 
            SuperscriptBox["sigma", "2"], " ", "t"}], 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
          FractionBox["mu", 
           RowBox[{"1", "+", "z"}]]}], ")"}]}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "alpha"}], " ", 
            SuperscriptBox["sigma", "2"], " ", "t"}], "+", 
           RowBox[{"mu", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "z"}], ")"}]}]}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["sigma", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"]}]]}]], " ", 
     SqrtBox[
      FractionBox["2", "\[Pi]"]], " ", "sigma", " ", "t"}], 
    RowBox[{"1", "+", "z"}]]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"alpha", " ", "t", " ", 
     RowBox[{"(", 
      RowBox[{"lambdaRef", "+", 
       FractionBox[
        RowBox[{"alpha", " ", 
         SuperscriptBox["sigma", "2"], " ", "t"}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
       FractionBox["mu", 
        RowBox[{"1", "+", "z"}]]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"alpha", " ", 
       SuperscriptBox["sigma", "2"], " ", 
       SuperscriptBox["t", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "+", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{"lambdaRef", "+", 
        FractionBox[
         RowBox[{"alpha", " ", 
          SuperscriptBox["sigma", "2"], " ", "t"}], 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "z"}], ")"}], "2"]}]], "-", 
        FractionBox["mu", 
         RowBox[{"1", "+", "z"}]]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Erf", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "alpha"}], " ", 
         SuperscriptBox["sigma", "2"], " ", "t"}], "+", 
        RowBox[{"mu", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "z"}], ")"}]}]}], 
       RowBox[{
        SqrtBox["2"], " ", "sigma", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "z"}], ")"}]}]], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.6748223148824778`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Priors", "Section",
 CellChangeTimes->{{3.674027503494664*^9, 3.674027505057879*^9}}],

Cell[CellGroupData[{

Cell["Rayleigh distribution and its derivatives", "Subsection",
 CellChangeTimes->{{3.673951893157229*^9, 3.6739519121474533`*^9}, {
  3.674027508479875*^9, 3.67402751219007*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{
   RowBox[{"RayleighDistribution", "[", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", "t"}]}], "]"}], ",", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.673951760572628*^9, 3.673951804019927*^9}, {
  3.673982045499086*^9, 3.673982072823729*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["z", "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"a", "+", 
                 RowBox[{"b", " ", "t"}]}], ")"}], "2"]}]]}]], " ", "z"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{"b", " ", "t"}]}], ")"}], "2"]], 
        RowBox[{"z", ">", "0"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.6739820732926292`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LogRayleighDistribution", "[", 
   RowBox[{"a_", ",", "b_", ",", "t_", ",", "z_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox["z", "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"a", "+", 
         RowBox[{"b", " ", "t"}]}], ")"}], "2"]}]]}], "+", 
   RowBox[{"Log", "[", "z", "]"}], "-", 
   RowBox[{"2", 
    RowBox[{"Log", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.673982055632915*^9, 3.673982119033278*^9}, {
  3.6744074136162043`*^9, 3.674407448817375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox["z", "2"], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"a", "+", 
        RowBox[{"b", " ", "t"}]}], ")"}], "2"]}]]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"a", "+", 
     RowBox[{"b", " ", "t"}]}], "]"}]}], "+", 
  RowBox[{"Log", "[", "z", "]"}]}]], "Output",
 CellChangeTimes->{
  3.673951804576022*^9, 3.673982089222165*^9, 3.673982120063221*^9, {
   3.674407419232822*^9, 3.674407449162423*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogRayleighDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "z"}], "]"}], ",", "a"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.673951807747838*^9, 3.673951810983477*^9}, {
  3.673982128495659*^9, 3.673982133221816*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["2", 
    RowBox[{"a", "+", 
     RowBox[{"b", " ", "t"}]}]]}], "+", 
  FractionBox[
   SuperscriptBox["z", "2"], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{
  3.67395181135742*^9, 3.673982133473633*^9, {3.674407423170994*^9, 
   3.674407451095726*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogRayleighDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "z"}], "]"}], ",", "b"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6739518148989563`*^9, 3.673951816999496*^9}, {
  3.67398213739116*^9, 3.673982138125654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "t"}], 
    RowBox[{"a", "+", 
     RowBox[{"b", " ", "t"}]}]]}], "+", 
  FractionBox[
   RowBox[{"t", " ", 
    SuperscriptBox["z", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{
  3.673951817470089*^9, 3.67398213860918*^9, {3.674407432705673*^9, 
   3.6744074524913607`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogRayleighDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "z"}], "]"}], ",", "t"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.673951820768433*^9, 3.673951820911405*^9}, {
  3.673982140600025*^9, 3.673982141965622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "b"}], 
    RowBox[{"a", "+", 
     RowBox[{"b", " ", "t"}]}]]}], "+", 
  FractionBox[
   RowBox[{"b", " ", 
    SuperscriptBox["z", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{
  3.673982150374545*^9, {3.67440743451053*^9, 3.6744074543362837`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogRayleighDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "z"}], "]"}], ",", "z"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6739821477662363`*^9, 3.6739821529652777`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "z"], "-", 
  FractionBox["z", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{
  3.673951821178961*^9, {3.67398214220224*^9, 3.6739821533027*^9}, {
   3.674407439796857*^9, 3.6744074559840517`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kumaraswamy distribution and its derivatives", "Subsection",
 CellChangeTimes->{{3.673952215608829*^9, 3.673952225322907*^9}, {
  3.673977793130975*^9, 3.673977793314784*^9}, {3.674027525006036*^9, 
  3.674027526174143*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{
   RowBox[{"KumaraswamyDistribution", "[", 
    RowBox[{"a", ",", "b"}], "]"}], ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.673952231095378*^9, 3.6739522313558207`*^9}, {
  3.673980971171527*^9, 3.673981033447172*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"a", " ", "b", " ", 
         SuperscriptBox["t", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "a"}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["t", "a"]}], ")"}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", "b"}]]}], 
        RowBox[{"0", "<", "t", "<", "1"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.673981045589005*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LogKumaraswamyDistribution", "[", 
   RowBox[{"a_", ",", "b_", ",", "t_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Log", "[", "a", "]"}], "+", 
   RowBox[{"Log", "[", " ", "b", "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "-", "1"}], ")"}], "*", 
    RowBox[{"Log", "[", " ", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "1"}], ")"}], "*", 
    RowBox[{"Log", " ", "[", 
     RowBox[{"1", "-", 
      SuperscriptBox["t", "a"]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.673981044784381*^9, 3.673981113917173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Log", "[", "a", "]"}], "+", 
  RowBox[{"Log", "[", "b", "]"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
   RowBox[{"Log", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "b"}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["t", "a"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.673980978229782*^9, 3.673981034085392*^9}, 
   3.6739811143882732`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogKumaraswamyDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t"}], "]"}], ",", "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.673980963972497*^9, 3.673980976401539*^9}, {
  3.673981118304083*^9, 3.673981129460486*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "a"], "+", 
  RowBox[{"Log", "[", "t", "]"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "b"}], ")"}], " ", 
    SuperscriptBox["t", "a"], " ", 
    RowBox[{"Log", "[", "t", "]"}]}], 
   RowBox[{"1", "-", 
    SuperscriptBox["t", "a"]}]]}]], "Output",
 CellChangeTimes->{
  3.673952235495084*^9, 3.673980980369501*^9, {3.673981118666274*^9, 
   3.673981130712743*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogKumaraswamyDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t"}], "]"}], ",", "b"}], "]"}]], "Input",
 CellChangeTimes->{{3.673952238266016*^9, 3.6739522383623247`*^9}, {
  3.673981135511179*^9, 3.6739811378684072`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "b"], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "-", 
    SuperscriptBox["t", "a"]}], "]"}]}]], "Output",
 CellChangeTimes->{3.673952238656061*^9, 3.673981138697093*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"LogKumaraswamyDistribution", "[", 
    RowBox[{"a", ",", "b", ",", "t"}], "]"}], ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.673952240602498*^9, 3.673952240754023*^9}, {
  3.6739811412461987`*^9, 3.6739811424439583`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["LogKumaraswamyDistribution", 
   TagBox[
    RowBox[{"(", 
     RowBox[{"0", ",", "0", ",", "1"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"a", ",", "b", ",", "t"}], "]"}]], "Output",
 CellChangeTimes->{3.674403897608911*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"KumaraswamyDistribution", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "t"}], "]"}], ",", "a"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.674403904324613*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"b", " ", 
            SuperscriptBox["t", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["t", "a"]}], ")"}], "b"]}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["t", "a"]}]]}], "+", 
         FractionBox[
          RowBox[{"a", " ", "b", " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "a"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], "b"], " ", 
           RowBox[{"Log", "[", "t", "]"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["t", "a"]}], ")"}], "2"]], "+", 
         FractionBox[
          RowBox[{"a", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "a"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "b"}]], " ", 
           RowBox[{"Log", "[", "t", "]"}]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["t", "a"]}]], "-", 
         FractionBox[
          RowBox[{"a", " ", "b", " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], "b"], " ", 
           RowBox[{"Log", "[", "t", "]"}]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["t", "a"]}]]}], 
        RowBox[{"0", "<", "t", "<", "1"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.674403905281295*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"KumaraswamyDistribution", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "t"}], "]"}], ",", "b"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.67440390889002*^9, 3.674403910442912*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"a", " ", 
            SuperscriptBox["t", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "a"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["t", "a"]}], ")"}], "b"]}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["t", "a"]}]]}], "-", 
         FractionBox[
          RowBox[{"a", " ", "b", " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], "b"], " ", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", 
             SuperscriptBox["t", "a"]}], "]"}]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["t", "a"]}]]}], 
        RowBox[{"0", "<", "t", "<", "1"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.6744039107991257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"KumaraswamyDistribution", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "t"}], "]"}], ",", "t"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674403914198378*^9, 3.674403914243293*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"0", 
        RowBox[{"t", "<", "0"}]},
       {
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["a", "2"], " ", "b", " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"2", " ", "a"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], "b"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["t", "a"]}], ")"}], "2"]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"2", " ", "a"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], 
            RowBox[{
             RowBox[{"-", "1"}], "+", "b"}]]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["t", "a"]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "a", " ", "b", " ", 
           SuperscriptBox["t", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "a"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["t", "a"]}], ")"}], "b"]}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["t", "a"]}]]}], 
        RowBox[{"0", "<", "t", "<", "1"}]},
       {"0", 
        RowBox[{"t", ">", "1"}]},
       {"Indeterminate", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.674403922426906*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Schechter distribution and its derivatives", "Subsection",
 CellChangeTimes->{{3.673977783095641*^9, 3.673977790555081*^9}, {
  3.674027527718926*^9, 3.6740275289172697`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"a_", ",", "b_", ",", "t_", ",", "lStar_", ",", "l_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", "*", "t"}]}], "]"}]}], "*", 
   RowBox[{"1", "/", "lStar"}], "*", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"l", "/", "lStar"}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "*", "t"}]}], ")"}]}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{"l", "/", "lStar"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.673977796672975*^9, 3.673977828578835*^9}, {
  3.6739779773490667`*^9, 3.673978010530231*^9}, {3.674572766679802*^9, 
  3.6745727683214273`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"l", "/", "lStar"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["l", "lStar"], ")"}], 
    RowBox[{"a", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}]]}], 
  RowBox[{"lStar", " ", 
   RowBox[{"Gamma", "[", 
    RowBox[{"a", "+", 
     RowBox[{"b", " ", "t"}]}], "]"}]}]]], "Output",
 CellChangeTimes->{3.673978011781247*^9, 3.674403966011484*^9, 
  3.6745727692491913`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"Gamma", "[", 
   RowBox[{"a", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "a"}], ")"}], "*", "t"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.674405931724515*^9, 3.674405967950095*^9}, {
  3.6744060869670486`*^9, 3.674406094415421*^9}, {3.674572772273521*^9, 
  3.67457277498524*^9}}],

Cell[BoxData[
 RowBox[{"Gamma", "[", 
  RowBox[{"a", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.674405933806683*^9, 3.6744059682505407`*^9}, 
   3.67440609475602*^9, 3.67457277545907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"logF", "[", 
   RowBox[{"a_", ",", "b_", ",", "t_", ",", "lStar_", ",", "l_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"LogGamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "*", "t"}], "+", "1"}], "]"}]}], "-", 
   
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "*", "t"}], "+", "1"}], ")"}], "*", 
    RowBox[{"Log", "[", "lStar", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "*", "t"}]}], ")"}], "*", 
    RowBox[{"Log", "[", "l", "]"}]}], "+", 
   RowBox[{"l", "/", "lStar"}]}]}]], "Input",
 CellChangeTimes->{{3.6739780138792343`*^9, 3.6739780420412397`*^9}, {
  3.673978102594895*^9, 3.673978190110785*^9}, {3.673979679064209*^9, 
  3.6739796793182*^9}, {3.6745727785054207`*^9, 3.674572787801482*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["l", "lStar"], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}], ")"}], " ", 
   RowBox[{"Log", "[", "l", "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "a", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}], ")"}], " ", 
   RowBox[{"Log", "[", "lStar", "]"}]}], "-", 
  RowBox[{"LogGamma", "[", 
   RowBox[{"1", "+", "a", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}], "]"}]}]], "Output",\

 CellChangeTimes->{3.674572788375903*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"logF", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "l"}], "]"}]], "Input",
 CellChangeTimes->{{3.6739781985824738`*^9, 3.673978200766382*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "lStar"], "+", 
  FractionBox[
   RowBox[{"a", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}], "l"]}]], "Output",\

 CellChangeTimes->{3.673978201046444*^9, 3.6739796827587013`*^9, 
  3.674572791387723*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"logF", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.67397827999749*^9, 3.673978280123781*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", 
   RowBox[{"Log", "[", "l", "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", 
   RowBox[{"Log", "[", "lStar", "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", 
   RowBox[{"PolyGamma", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", "a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.673978280415326*^9, 3.673979684179123*^9, 
  3.67457279280752*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"logF", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.673978395035433*^9, 3.673978395139989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "t"}], ")"}], " ", 
   RowBox[{"Log", "[", "l", "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "t"}], ")"}], " ", 
   RowBox[{"Log", "[", "lStar", "]"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "t"}], ")"}], " ", 
   RowBox[{"PolyGamma", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", "a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.6739783954085073`*^9, 3.673979686762053*^9, 
  3.674572794192507*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"logF", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "b"}], "]"}]], "Input",
 CellChangeTimes->{{3.6739784211947308`*^9, 3.673978421355142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", " ", 
   RowBox[{"Log", "[", "l", "]"}]}], "-", 
  RowBox[{"t", " ", 
   RowBox[{"Log", "[", "lStar", "]"}]}], "-", 
  RowBox[{"t", " ", 
   RowBox[{"PolyGamma", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", "a", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}]}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.673978421841076*^9, 3.673979688375201*^9, 
  3.6745727972679*^9, 3.674573047726959*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"logF", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "lStar"}], "]"}]], "Input",
 CellChangeTimes->{{3.674404248904497*^9, 3.674404251301998*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["l", 
    SuperscriptBox["lStar", "2"]]}], "-", 
  FractionBox[
   RowBox[{"1", "+", "a", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "a"}], "+", "b"}], ")"}], " ", "t"}]}], 
   "lStar"]}]], "Output",
 CellChangeTimes->{{3.674404253851617*^9, 3.674404259516903*^9}, 
   3.674405116476767*^9, 3.6745727965164957`*^9}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "a"}], "]"}]], "Input",
 CellChangeTimes->{{3.674403976380032*^9, 3.6744039988570013`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", 
    RowBox[{"Log", "[", 
     FractionBox["l", "lStar"], "]"}]}], 
   RowBox[{"lStar", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", 
    RowBox[{"PolyGamma", "[", 
     RowBox[{"0", ",", 
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "t"}]}]}], "]"}]}], 
   RowBox[{"lStar", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.674403992425639*^9, 3.674404000254237*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "b"}], "]"}]], "Input",
 CellChangeTimes->{{3.6744039803385572`*^9, 3.674404002265353*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", "t", " ", 
    RowBox[{"Log", "[", 
     FractionBox["l", "lStar"], "]"}]}], 
   RowBox[{"lStar", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", "t", " ", 
    RowBox[{"PolyGamma", "[", 
     RowBox[{"0", ",", 
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "t"}]}]}], "]"}]}], 
   RowBox[{"lStar", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.674404002602363*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.674403983263999*^9, 3.67440401161593*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"b", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", 
    RowBox[{"Log", "[", 
     FractionBox["l", "lStar"], "]"}]}], 
   RowBox[{"lStar", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]], "-", 
  FractionBox[
   RowBox[{"b", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", 
    RowBox[{"PolyGamma", "[", 
     RowBox[{"0", ",", 
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "t"}]}]}], "]"}]}], 
   RowBox[{"lStar", " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.674404011798822*^9}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "lStar"}], "]"}]], "Input",
 CellChangeTimes->{{3.674403984682694*^9, 3.674404014539233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"l", "/", "lStar"}]], " ", "l", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["l", "lStar"], ")"}], 
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "t"}]}]]}], 
    RowBox[{
     SuperscriptBox["lStar", "3"], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "t"}]}], "]"}]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]]}], 
   RowBox[{
    SuperscriptBox["lStar", "2"], " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", "l", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["lStar", "3"], " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.6744040147710342`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"a", ",", "b", ",", "t", ",", "lStar", ",", "l"}], "]"}], ",", 
   "l"}], "]"}]], "Input",
 CellChangeTimes->{{3.674403990835986*^9, 3.674404016710464*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}]]}], 
   RowBox[{
    SuperscriptBox["lStar", "2"], " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"l", "/", "lStar"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["l", "lStar"], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a", "+", 
      RowBox[{"b", " ", "t"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["lStar", "2"], " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"a", "+", 
      RowBox[{"b", " ", "t"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{3.6744040172203093`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.674121097610261*^9, 3.674121099136723*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean function and luminosity distance", "Section",
 CellChangeTimes->{{3.674121105542396*^9, 3.674121125655498*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "[", 
   RowBox[{"z_", ",", "l_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "z"}], ")"}], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"DL", "[", "z", "]"}], ")"}], "^", "2"}]}], " ", "/", 
    "FourPi"}], "*", 
   RowBox[{"l", "/", "g_AB"}]}]}]], "Input",
 CellChangeTimes->{{3.674120904710064*^9, 3.674120951600443*^9}, {
  3.674121033013229*^9, 3.674121039828671*^9}, {3.674121363960698*^9, 
  3.674121372427526*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"l", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "z"}], ")"}]}], 
  RowBox[{"FourPi", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "21.7`"}], "+", 
      RowBox[{"30.5`", " ", 
       SuperscriptBox["z", "0.04`"]}]}], ")"}], "2"], " ", 
   "g_AB"}]]], "Output",
 CellChangeTimes->{
  3.6741209525171843`*^9, {3.674121034191751*^9, 3.674121040370975*^9}, 
   3.6741213729625196`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"z", ",", "l"}], "]"}], ",", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.6741209644271393`*^9, 3.674120973275674*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["l", 
   RowBox[{"FourPi", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "21.7`"}], "+", 
       RowBox[{"30.5`", " ", 
        SuperscriptBox["z", "0.04`"]}]}], ")"}], "2"], " ", "g_AB"}]], "-", 
  FractionBox[
   RowBox[{"2.44`", " ", "l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "z"}], ")"}]}], 
   RowBox[{"FourPi", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "21.7`"}], "+", 
       RowBox[{"30.5`", " ", 
        SuperscriptBox["z", "0.04`"]}]}], ")"}], "3"], " ", 
    SuperscriptBox["z", "0.96`"], " ", "g_AB"}]]}]], "Output",
 CellChangeTimes->{{3.674120967766663*^9, 3.6741209743791933`*^9}, {
   3.674121036988409*^9, 3.67412104277302*^9}, 3.6741213791411057`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"z", ",", "l"}], "]"}], ",", "l"}], "]"}]], "Input",
 CellChangeTimes->{{3.674121050802752*^9, 3.6741210509781933`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", "z"}], 
  RowBox[{"FourPi", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "21.7`"}], "+", 
      RowBox[{"30.5`", " ", 
       SuperscriptBox["z", "0.04`"]}]}], ")"}], "2"], " ", 
   "g_AB"}]]], "Output",
 CellChangeTimes->{3.6741211324930477`*^9, 3.674121381939788*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DL", "[", "z_", "]"}], "=", 
  RowBox[{
   RowBox[{"30.5", "*", 
    RowBox[{"z", "^", "0.04"}]}], "-", "21.7"}]}]], "Input",
 CellChangeTimes->{{3.674121129569016*^9, 3.674121151359701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "21.7`"}], "+", 
  RowBox[{"30.5`", " ", 
   SuperscriptBox["z", "0.04`"]}]}]], "Output",
 CellChangeTimes->{{3.674121129646627*^9, 3.6741211523914223`*^9}, 
   3.67412138341742*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"DL", "[", "z", "]"}], ",", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.674121153736726*^9, 3.674121156407333*^9}}],

Cell[BoxData[
 FractionBox["1.22`", 
  SuperscriptBox["z", "0.96`"]]], "Output",
 CellChangeTimes->{3.674121156746944*^9, 3.674121384764614*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivative of GP kernel with respect to redshift", "Section",
 CellChangeTimes->{{3.674574560271649*^9, 3.674574575191428*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "z_", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "z"}], ")"}], "/", 
      RowBox[{"D_L", "[", "z", "]"}]}], ")"}], "^", "2"}], "*", 
   RowBox[{"g", "[", "z", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6745745901273937`*^9, 3.674574593694895*^9}, {
  3.6745750487627687`*^9, 3.674575079656745*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "z"}], ")"}], "2"], " ", 
   RowBox[{"g", "[", "z", "]"}]}], 
  SuperscriptBox[
   RowBox[{"D_L", "[", "z", "]"}], "2"]]], "Output",
 CellChangeTimes->{{3.6745750637792797`*^9, 3.674575080046489*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"f", "[", "z", "]"}], ",", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.674575068732957*^9, 3.674575072000009*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "z"}], ")"}], " ", 
    RowBox[{"g", "[", "z", "]"}]}], 
   SuperscriptBox[
    RowBox[{"D_L", "[", "z", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z"}], ")"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["g", "\[Prime]",
      MultilineFunction->None], "[", "z", "]"}]}], 
   SuperscriptBox[
    RowBox[{"D_L", "[", "z", "]"}], "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "z"}], ")"}], "2"], " ", 
    RowBox[{"g", "[", "z", "]"}], " ", 
    RowBox[{
     SuperscriptBox["D_L", "\[Prime]",
      MultilineFunction->None], "[", "z", "]"}]}], 
   SuperscriptBox[
    RowBox[{"D_L", "[", "z", "]"}], "3"]]}]], "Output",
 CellChangeTimes->{{3.6745750724993773`*^9, 3.674575081801991*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{820, 851},
WindowMargins->{{Automatic, 973}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 214, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[797, 27, 100, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[922, 32, 169, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1116, 38, 1553, 47, 80, "Input"],
Cell[2672, 87, 1753, 57, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4462, 149, 2083, 62, 85, "Input"],
Cell[6548, 213, 1886, 59, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8471, 277, 232, 6, 28, "Input"],
Cell[8706, 285, 6281, 198, 305, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15024, 488, 366, 8, 28, "Input"],
Cell[15393, 498, 7175, 212, 451, "Output"],
Cell[22571, 712, 27, 0, 28, "Output"]
}, Open  ]],
Cell[22613, 715, 1290, 42, 74, "Input"],
Cell[23906, 759, 26, 0, 28, "Input"],
Cell[CellGroupData[{
Cell[23957, 763, 1284, 32, 63, "Input"],
Cell[25244, 797, 1475, 41, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26756, 843, 1146, 35, 58, InheritFromParent],
Cell[27905, 880, 966, 30, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28908, 915, 256, 6, 28, InheritFromParent],
Cell[29167, 923, 2870, 88, 192, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32074, 1016, 205, 5, 28, InheritFromParent],
Cell[32282, 1023, 2841, 88, 136, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35184, 1118, 91, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[35300, 1123, 179, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[35504, 1129, 293, 7, 28, "Input"],
Cell[35800, 1138, 2040, 60, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37877, 1203, 642, 19, 54, "Input"],
Cell[38522, 1224, 536, 17, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39095, 1246, 291, 7, 28, "Input"],
Cell[39389, 1255, 406, 14, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39832, 1274, 292, 7, 28, "Input"],
Cell[40127, 1283, 458, 16, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40622, 1304, 291, 7, 28, "Input"],
Cell[40916, 1313, 432, 15, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41385, 1333, 246, 6, 28, "Input"],
Cell[41634, 1341, 335, 10, 51, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42018, 1357, 230, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[42273, 1364, 272, 6, 28, "Input"],
Cell[42548, 1372, 1868, 55, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44453, 1432, 593, 17, 51, "Input"],
Cell[45049, 1451, 524, 17, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45610, 1473, 281, 6, 28, "Input"],
Cell[45894, 1481, 464, 15, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46395, 1501, 285, 6, 28, "Input"],
Cell[46683, 1509, 215, 6, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46935, 1520, 285, 6, 28, "Input"],
Cell[47223, 1528, 296, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47556, 1542, 258, 8, 28, "Input"],
Cell[47817, 1552, 3604, 105, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51458, 1662, 281, 8, 28, "Input"],
Cell[51742, 1672, 2521, 74, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54300, 1751, 282, 8, 28, "Input"],
Cell[54585, 1761, 3297, 98, 101, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57931, 1865, 181, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[58137, 1871, 764, 22, 46, "Input"],
Cell[58904, 1895, 549, 18, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59490, 1918, 353, 9, 28, "Input"],
Cell[59846, 1929, 293, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60176, 1942, 1004, 29, 46, "Input"],
Cell[61183, 1973, 739, 26, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61959, 2004, 240, 6, 28, "Input"],
Cell[62202, 2012, 314, 11, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62553, 2028, 237, 6, 28, "Input"],
Cell[62793, 2036, 705, 25, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63535, 2066, 238, 6, 28, "Input"],
Cell[63776, 2074, 645, 22, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64458, 2101, 240, 6, 28, "Input"],
Cell[64701, 2109, 516, 16, 28, "Output"]
}, Open  ]],
Cell[65232, 2128, 242, 6, 28, InheritFromParent],
Cell[65477, 2136, 400, 13, 49, "Output"],
Cell[65880, 2151, 237, 6, 28, InheritFromParent],
Cell[66120, 2159, 1043, 34, 61, "Output"],
Cell[CellGroupData[{
Cell[67188, 2197, 237, 6, 28, "Input"],
Cell[67428, 2205, 1039, 34, 61, "Output"]
}, Open  ]],
Cell[68482, 2242, 234, 6, 28, InheritFromParent],
Cell[68719, 2250, 1039, 34, 61, "Output"],
Cell[69761, 2286, 239, 6, 28, InheritFromParent],
Cell[70003, 2294, 1446, 49, 62, "Output"],
Cell[CellGroupData[{
Cell[71474, 2347, 235, 6, 28, "Input"],
Cell[71712, 2355, 994, 34, 118, "Output"]
}, Open  ]],
Cell[72721, 2392, 92, 1, 28, InheritFromParent]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72862, 2399, 122, 1, 99, "Section"],
Cell[CellGroupData[{
Cell[73009, 2404, 521, 16, 28, "Input"],
Cell[73533, 2422, 452, 15, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74022, 2442, 199, 5, 28, "Input"],
Cell[74224, 2449, 790, 23, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75051, 2477, 199, 5, 28, "Input"],
Cell[75253, 2484, 348, 11, 55, "Output"]
}, Open  ]],
Cell[75616, 2498, 226, 6, 28, InheritFromParent],
Cell[75845, 2506, 221, 6, 32, "Output"],
Cell[CellGroupData[{
Cell[76091, 2516, 173, 4, 28, "Input"],
Cell[76267, 2522, 144, 3, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76460, 2531, 133, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[76618, 2536, 423, 12, 28, "Input"],
Cell[77044, 2550, 299, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77380, 2564, 172, 4, 28, "Input"],
Cell[77555, 2570, 925, 30, 53, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
